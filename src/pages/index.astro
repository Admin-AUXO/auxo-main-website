---
import BaseLayout from "../layouts/BaseLayout.astro";
import Navigation from "../components/Navigation.astro";
import { siteData } from "../data/config/site";
import {
  homepageContent,
  type HomepageContent,
} from "../data/content/homepage";

// Section Components
import HeroSection from "../components/sections/HeroSection.astro";
import ServicesSection from "../components/sections/ServicesSection.astro";
import MethodologySection from "../components/sections/MethodologySection.astro";
import WhyChooseSection from "../components/sections/WhyChooseSection.astro";
import MaturityCalculatorSection from "../components/sections/MaturityCalculatorSection.astro";
import BlogPreview from "../components/sections/BlogPreview.astro";
import LaunchOfferSection from "../components/sections/LaunchOfferSection.astro";
import FinalCtaSection from "../components/sections/FinalCtaSection.astro";

// Styles and Scripts
import "../styles/homepage.css";
---

<BaseLayout
  title="Data Analytics Consultancy Dubai, UAE | AUXO Data Labs"
  description={siteData.description}
  showNav={false}
  showParticles={true}
>
  <Navigation />

  <HeroSection />

  <ServicesSection />

  <MethodologySection />

  <WhyChooseSection />

  <MaturityCalculatorSection />

  <BlogPreview />

  <LaunchOfferSection />

  <FinalCtaSection />

  <script>
    // Setup homepage animations
    function setupHomepageAnimations() {
      // Run hero animation
      function runHeroAnimation() {
        const heroSection = document.getElementById("hero");
        if (!heroSection) return;
        heroSection.classList.remove("hero-animate");
        heroSection.classList.add("hero-animation-reset");
        void heroSection.offsetWidth;
        heroSection.classList.remove("hero-animation-reset");
        heroSection.classList.add("hero-animate");
      }

      // Setup intersection observer
      function setupIntersectionObserver() {
        const prefersReducedMotion = window.matchMedia(
          "(prefers-reduced-motion: reduce)",
        ).matches;

        if (prefersReducedMotion) {
          document.querySelectorAll(".animate-fade-in").forEach((el) => {
            (el as HTMLElement).style.opacity = "1";
          });
          return;
        }

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const element = entry.target as HTMLElement;
                element.style.opacity = "1";
                const delay = element.getAttribute("data-animation-delay");
                if (delay) {
                  element.style.animationDelay = `${delay}ms`;
                }
                observer.unobserve(element);
              }
            });
          },
          {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px",
          },
        );

        document.querySelectorAll(".animate-fade-in").forEach((el) => {
          observer.observe(el);
        });
      }

      runHeroAnimation();
      setupIntersectionObserver();
    }

    // Initialize
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", setupHomepageAnimations);
    } else {
      setupHomepageAnimations();
    }

    document.addEventListener("astro:page-load", setupHomepageAnimations);
  </script>
</BaseLayout>

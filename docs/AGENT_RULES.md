# AI Agent Rules & Guidelines

**This is a mandatory read for all AI Coding Agents.** You must read and understand these rules before making any changes to the codebase.

---

## Introduction for AI Coding Agents

Welcome, Agent. Your primary directive is to assist in the development and maintenance of the AUXO Data Labs corporate website. This document contains the core rules and guidelines you must follow.

This project is a modern, high-performance static site built with Astro. Your goal is to understand its structure and conventions to make safe, efficient, and consistent changes.

---

## Pre-Work Checklist

Before making any changes:

1. **Read ALL Documentation:** Familiarize yourself with:
   - This file (`AGENT_RULES.md`)
   - All files in the `docs/` directory
   - `README.md` in the project root
   - Relevant sections of `ARCHITECTURE.md`, `BRAND_GUIDELINES.md`, `CONTENT_GUIDELINES.md`

2. **Understand the Request:** Analyze the user's request fully before proceeding.

3. **Plan Your Approach:** Create a clear plan using the documentation as reference.

---

## Core Principles

- **Static First:** This is a static site generated by Astro. Prioritize static generation and minimize client-side JavaScript wherever possible.
- **Component-Based Architecture:** The site is built with reusable Astro components found in `src/components/`. Always look for existing components to reuse before creating new ones.
- **Data-Driven Content:** Most of the site's content is managed in TypeScript files in `src/data/`. When updating content, this should be your first stop.
- **TypeScript Everywhere:** The project uses TypeScript for type safety. Ensure all new code is strongly typed.
- **Utility-First CSS:** The project uses Tailwind CSS. Adhere to its utility-first principles and use the existing design tokens defined in `tailwind.config.js` and `src/styles/global.css`.
- **Mobile-First Design:** The site uses a mobile-first responsive design approach. All components are optimized for touch interactions with minimum 44px × 44px touch targets, proper spacing, and mobile-friendly layouts.

---

## Project Root & Command Syntax

**CRITICAL:** Before running any commands, ensure you're in the correct project directory.

- **Project Root:** `A:\AUXO\Main Website`
- **Always navigate to project root first:** `cd "A:\AUXO\Main Website"`
- **PowerShell Syntax:** PowerShell does NOT support `&&` operator. Use one of these methods:
  - **Separate commands:** Run each command individually
  - **Semicolon separator:** `cd "A:\AUXO\Main Website"; npm run build` (PowerShell-specific)
  - **Do NOT use:** `cd "A:\AUXO\Main Website" && npm run build` (this will fail in PowerShell)

**Example Correct Usage:**
```powershell
# Method 1: Separate commands
cd "A:\AUXO\Main Website"
npm run build

# Method 2: Semicolon (PowerShell)
cd "A:\AUXO\Main Website"; npm run build
```

**Common Mistake to Avoid:**
- ❌ `cd "A:\AUXO\Main Website" && npm run build` (fails in PowerShell)
- ✅ `cd "A:\AUXO\Main Website"; npm run build` (PowerShell syntax)
- ✅ Separate commands (safest approach)

## Development Workflow

1. **Analyze the Request:** Understand the user's request and context.
2. **Read Documentation:** Review relevant docs to understand existing patterns.
3. **Formulate a Plan:** Create a clear plan using this documentation.
4. **Navigate to Project Root:** Always ensure you're in `A:\AUXO\Main Website` before running commands.
5. **Implement Changes:** Follow the project's core principles and coding conventions.
6. **Run Local Checks:** Ensure these commands run successfully from the project root:
   - `npm run lint`: Checks for linting errors.
   - `npm run check`: TypeScript type checking.
   - `npm run build`: Verifies the site builds successfully.
7. **Confirm with User:** 
   - For small changes: Confirm before pushing to GitHub
   - After completing work: Ask if there's anything else to be done
8. **Update Documentation:** If your changes alter project structure, add components, or modify features, update the relevant documentation files.

---

## Ground Rules

1. **Adhere to Existing Conventions:** Mimic the style, structure, and patterns of the existing code.
2. **No New Dependencies:** Do not introduce new libraries or frameworks without explicit instruction.
3. **Update Documentation:** Update relevant documentation files when your changes alter the project's structure, add components, or modify existing features.
4. **Small Changes Confirmation:** For small, straightforward changes, confirm with the user before pushing to GitHub.
5. **Completion Check:** After completing work, always ask the user if there's anything else to be done.

---

## Code Style & Conventions

### Comments

Add comments only when necessary to explain *why* a piece of code is written a certain way, not *what* it does. Avoid obvious comments.

### Naming Conventions

- **Components:** `PascalCase` (e.g., `MyComponent.astro`)
- **Variables and functions:** `camelCase` (e.g., `myVariable`, `myFunction`)
- **TypeScript interfaces:** `PascalCase` (e.g., `MyInterface`)

### Import Organization

Keep imports organized at the top of the file, grouped as follows:

1. Astro imports
2. Third-party library imports
3. Internal component imports
4. Data imports
5. Type imports

### Tailwind CSS

While there is no strict linter for class order, try to follow a consistent pattern (e.g., layout, spacing, typography, colors, effects).

### Mobile Optimization

When adding or modifying components, ensure:

- Touch targets are at least 44px × 44px (use `min-h-[44px]` or `min-w-[44px]`)
- Use `touch-manipulation` CSS for better mobile performance
- Add `active:` states alongside `hover:` for touch feedback
- Use responsive spacing (`px-4 sm:px-6`, `py-3 sm:py-2`)

---

## Dos and Don'ts (Best Practices)

### Content Management

**DO:**
- Use the organized data structure in `src/data/`:
  - Use `config/` for site-wide settings
  - Use `collections/` for structured data (services, FAQ, team)
  - Use `content/` for page-specific content
  - Use `shared/common.ts` for reusable text (buttons, labels, CTAs)
- Maintain TypeScript interfaces for all data structures - export interfaces alongside data
- Organize content logically - page content belongs in `content/`, shared text in `shared/`

**DON'T:**
- Hard-code strings directly into components or pages - 80% of files now use data files, maintain this pattern
- Mix content types - don't put page content in `collections/` or shared text in page-specific files
- Create duplicate data - check `shared/common.ts` before adding new common text

### Component Development

**DO:**
- Reuse existing components from `src/components/` whenever possible
- Ensure all new components and pages are accessible (a11y) by using semantic HTML and ARIA attributes where necessary. The ESLint configuration will help with this.
- Use mobile-first responsive design with 44px × 44px minimum touch targets
- Add `active:` states alongside `hover:` for better touch feedback

**DON'T:**
- Duplicate code. If you find yourself writing the same code in multiple places, create a reusable component.
- Create components that mix concerns - keep UI components separate from business logic

### Performance & Architecture

**DO:**
- Use Astro's `getCollection` API to query blog posts from `src/content/blog/`
- Keep client-side JavaScript minimal - this is a static-first site

**DON'T:**
- Add large client-side JavaScript libraries without a very strong justification
- Bypass Astro's static generation - prefer server-side rendering over client-side where possible

### Navigation & URLs

**DO:**
- Use the `base` variable (`import.meta.env.BASE_URL`) for all internal links and API calls
- Use relative paths with base URL prefix (e.g., `<a href={`${base}about`}>About</a>`)

**DON'T:**
- Use `<a>` tags for internal navigation without using the `base` variable
- Hardcode absolute URLs in client-side scripts - always use `import.meta.env.BASE_URL`

### Security & Configuration

**DO:**
- Verify Brevo sender email is verified before deploying contact forms
- Test API endpoints with proper validation and rate limiting
- Keep security headers up to date in `public/_headers`

**DON'T:**
- Commit `.cursor/mcp.json` or any MCP configuration files (contains secrets)
- Expose API keys, tokens, or sensitive data in code, commits, or documentation
- Bypass validation or rate limiting in API endpoints
- Commit `.env` files or environment variables with real values

---

## Common "Gotchas" to Avoid

### Client-side Scripts

Remember that Astro components are server-only by default. If you need to add client-side interactivity, you must use a `<script>` tag within the `.astro` file. The existing interactive components like `MultiStepForm.astro` and `MaturityCalculator.astro` are good examples of this pattern.

### API Endpoints

The API endpoints in `src/pages/api/` are fully integrated with Brevo for email delivery. They have comprehensive Zod validation and rate limiting implemented. **IMPORTANT:** Brevo requires verified sender emails before any emails can be sent. Ensure `BREVO_FROM_EMAIL` is verified in your Brevo dashboard.

### Base URL

The project is configured with a `base` URL in `astro.config.mjs`. All internal links and asset paths must be prefixed with the `base` variable to work correctly in both development and production. **Critical:** API calls in client-side scripts must also use the base URL (e.g., `fetch(\`${import.meta.env.BASE_URL}api/contact\`)`).

### Image Optimization

While Astro's image optimization is powerful, be mindful of the image formats and sizes you use. Large, unoptimized images can still slow down the site.

### ESLint Configuration

The project uses ESLint v9 with flat config format (`eslint.config.js`). The accessibility rule `jsx-a11y/label-has-associated-control` is configured to properly recognize `for` attribute associations in Astro components. Do not revert to the old `.eslintrc.cjs` format.

### Theme System (Dark/Light Mode)

The website supports both dark and light themes with a comprehensive theme toggle system. **Critical rules for AI agents:**

- **Theme Toggle Button:**
  - Located in the navigation bar (desktop and mobile)
  - Component: `src/components/ThemeToggle.astro`
  - Toggles between `dark` and `light` classes on the `<html>` element
  - Theme preference is stored in `localStorage` and persists across sessions
  - System preference detection on first visit

- **Theme-Aware Colors:**
  - **NEVER use hardcoded colors** like `text-white`, `text-black`, `bg-black`, `bg-white`
  - **ALWAYS use theme-aware CSS variables:**
    - Text: `text-primary`, `text-secondary`, `text-tertiary`
    - Backgrounds: `bg-primary`, `bg-card`, `bg-surface`, `bg-secondary`
    - Borders: `border-theme`, `border-theme-light`
    - Accents: `accent-green` (theme-aware green)
  
- **Button Text Colors:**
  - **Green buttons** (`bg-accent-green`): Use `text-black dark:text-white` for proper contrast
  - Dark theme: White text on green buttons
  - Light theme: Black text on green buttons
  - **DO NOT** use `text-white` alone - always pair with `dark:text-white` or use theme-aware variables

- **CSS Variables:**
  - All colors defined in `src/styles/global.css` using CSS custom properties
  - Dark theme: `:root.dark` or `:root:not(.light)`
  - Light theme: `:root.light`
  - Variables automatically adjust based on theme class

- **Particle Background:**
  - Particles use pure black/white based on theme
  - Text must be optimized for readability over pure black/white backgrounds
  - Use solid backgrounds (`bg-card`, `bg-surface`) for text containers
  - Ensure sufficient contrast for all text elements

- **Testing Themes:**
  - Always test components in both dark and light themes
  - Verify text contrast meets WCAG AA standards in both themes
  - Check that buttons and interactive elements are readable in both themes
  - Ensure no black text appears in dark theme (except on green buttons)
  - Ensure no white text appears in light theme

- **Logo Colors:**
  - Logo uses fixed green color `#A3E635` in both themes
  - Do not change logo colors based on theme

- **Best Practices:**
  - Use `transition-colors` class for smooth theme transitions
  - Test all new components in both themes before submitting
  - Avoid shadows/glow effects - use color changes instead for readability
  - Ensure box backgrounds have sufficient opacity for text readability over particles

---

## MCP Server Usage Guidelines

The project uses Model Context Protocol (MCP) servers for enhanced capabilities. **Important rules:**

### MCP Server Configuration

- **Location:** `.cursor/mcp.json` (local configuration file)
- **Git Status:** This file is in `.gitignore` and must **NEVER** be committed to the repository
- **Reason:** Contains sensitive tokens (GitHub Personal Access Tokens, API keys)

### Available MCP Servers

1. **filesystem:** File system operations within the project directory
2. **sqlite:** Database operations (if needed)
3. **github:** GitHub API operations (repository management, issues, PRs)
4. **playwright:** Browser automation and testing
5. **astro-docs:** Access to Astro framework documentation

### Usage Rules

- **NEVER commit `.cursor/mcp.json`:** This file contains secrets and is excluded from git
- **NEVER commit `.cursor/` directory:** All MCP configuration is local-only
- **Use MCP servers for:**
  - Reading/writing files efficiently
  - GitHub repository operations (creating PRs, reading issues)
  - Searching Astro documentation
  - Browser automation when testing
- **Do NOT expose tokens:** Never include MCP tokens in code, commits, or documentation
- **File operations:** Prefer MCP filesystem tools for large-scale file operations
- **GitHub operations:** Use MCP GitHub server for repository management instead of direct git commands when appropriate

### Security Best Practices

- Treat MCP configuration files as sensitive data
- If you see `.cursor/mcp.json` in git status, it should be removed from tracking
- All MCP-related files are already in `.gitignore`
- When using GitHub MCP server, be mindful of rate limits and token permissions

---

## Communication Protocol

### After Completing Work

Always ask the user:
- "Are there any additional changes you'd like me to make?"
- "Should I proceed with pushing these changes to GitHub?" (for small changes)
- "Is there anything else you need help with?"

### Before Major Changes

For significant changes:
- Confirm the approach with the user
- Explain what will be modified
- Get approval before proceeding

---

## Documentation Updates

When your changes affect:
- **Project structure:** Update `ARCHITECTURE.md`
- **Brand/design elements:** Update `BRAND_GUIDELINES.md`
- **Content patterns:** Update `CONTENT_GUIDELINES.md`
- **New components:** Update `COMPONENTS.md`
- **New APIs:** Update `API_ENDPOINTS.md`
- **Security changes:** Update `SECURITY.md`
- **Configuration changes:** Update `ENVIRONMENT_VARIABLES.md`
- **Data structures:** Update `DATA_STRUCTURES.md`

---

## Summary

**Remember:** Always read the documentation, follow conventions, test your changes, and communicate with the user. When in doubt, ask before proceeding.


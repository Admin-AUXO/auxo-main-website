---
import BaseLayout from '../layouts/BaseLayout.astro';
import { Icon } from 'astro-icon/components';
---

<BaseLayout
  title="Data Analytics Maturity Assessment | AUXO Data Labs"
  description="Discover your organization's data analytics maturity level with our free interactive assessment. Get personalized recommendations to advance your data capabilities."
>
  <div class="pt-24 pb-16">
    <div class="container mx-auto px-4">
      <!-- Header -->
      <div class="max-w-4xl mx-auto text-center mb-12">
        <div class="inline-block px-4 py-2 bg-lime-400/10 border border-lime-400/20 rounded-full mb-4">
          <span class="text-lime-400 text-sm font-semibold">Free Assessment Tool</span>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold mb-4">
          Data Analytics
          <span class="text-lime-400"> Maturity Assessment</span>
        </h1>
        <p class="text-xl text-gray-400 mb-6">
          Discover where your organization stands and get personalized recommendations for growth
        </p>
        <p class="text-sm text-gray-500">Takes about 5 minutes • 20 questions across 5 dimensions</p>
      </div>

      <!-- Assessment Container -->
      <div class="max-w-4xl mx-auto">
        <!-- Introduction Screen -->
        <div id="intro-screen" class="bg-zinc-900 border border-zinc-800 rounded-2xl p-8 md:p-12">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <div class="bg-zinc-800 p-6 rounded-lg">
              <Icon name="mdi:chart-line" class="w-10 h-10 text-lime-400 mb-3" />
              <h3 class="font-bold mb-2">What You'll Get</h3>
              <ul class="text-sm text-gray-400 space-y-2">
                <li>• Your maturity score across 5 key dimensions</li>
                <li>• Personalized improvement roadmap</li>
                <li>• Comparison with industry benchmarks</li>
                <li>• Downloadable PDF report</li>
              </ul>
            </div>

            <div class="bg-zinc-800 p-6 rounded-lg">
              <Icon name="mdi:lock" class="w-10 h-10 text-lime-400 mb-3" />
              <h3 class="font-bold mb-2">Your Privacy</h3>
              <ul class="text-sm text-gray-400 space-y-2">
                <li>• No registration required</li>
                <li>• Completely anonymous</li>
                <li>• Instant results</li>
                <li>• Optional: Save results via email</li>
              </ul>
            </div>
          </div>

          <div class="bg-gradient-to-r from-lime-400/10 to-green-500/10 border border-lime-400/20 rounded-lg p-6 mb-8">
            <h3 class="font-bold mb-3">The 5 Dimensions We Assess:</h3>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4">
              <div class="text-center">
                <div class="w-12 h-12 bg-lime-400/20 rounded-full flex items-center justify-center mx-auto mb-2">
                  <Icon name="mdi:database" class="w-6 h-6 text-lime-400" />
                </div>
                <p class="text-sm font-medium">Data Infrastructure</p>
              </div>
              <div class="text-center">
                <div class="w-12 h-12 bg-lime-400/20 rounded-full flex items-center justify-center mx-auto mb-2">
                  <Icon name="mdi:chart-bar" class="w-6 h-6 text-lime-400" />
                </div>
                <p class="text-sm font-medium">Analytics Capabilities</p>
              </div>
              <div class="text-center">
                <div class="w-12 h-12 bg-lime-400/20 rounded-full flex items-center justify-center mx-auto mb-2">
                  <Icon name="mdi:account-group" class="w-6 h-6 text-lime-400" />
                </div>
                <p class="text-sm font-medium">People & Skills</p>
              </div>
              <div class="text-center">
                <div class="w-12 h-12 bg-lime-400/20 rounded-full flex items-center justify-center mx-auto mb-2">
                  <Icon name="mdi:lightbulb" class="w-6 h-6 text-lime-400" />
                </div>
                <p class="text-sm font-medium">Data Culture</p>
              </div>
              <div class="text-center">
                <div class="w-12 h-12 bg-lime-400/20 rounded-full flex items-center justify-center mx-auto mb-2">
                  <Icon name="mdi:shield-check" class="w-6 h-6 text-lime-400" />
                </div>
                <p class="text-sm font-medium">Governance</p>
              </div>
            </div>
          </div>

          <button id="start-btn" class="w-full py-4 bg-lime-400 text-black font-bold rounded-lg hover:bg-lime-500 transition-all transform hover:scale-105">
            Start Assessment →
          </button>
        </div>

        <!-- Question Screen -->
        <div id="question-screen" class="hidden bg-zinc-900 border border-zinc-800 rounded-2xl p-8 md:p-12">
          <!-- Progress -->
          <div class="mb-8">
            <div class="flex justify-between items-center mb-2">
              <span class="text-sm text-gray-400">Question <span id="q-num">1</span> of 20</span>
              <span class="text-sm text-gray-400"><span id="q-progress">5</span>% Complete</span>
            </div>
            <div class="h-2 bg-zinc-800 rounded-full overflow-hidden">
              <div id="q-bar" class="h-full bg-gradient-to-r from-lime-400 to-green-500 transition-all duration-300" style="width: 5%"></div>
            </div>
          </div>

          <!-- Category Badge -->
          <div class="inline-block px-4 py-2 bg-lime-400/10 border border-lime-400/20 rounded-full mb-4">
            <span id="category-name" class="text-lime-400 text-sm font-semibold"></span>
          </div>

          <!-- Question -->
          <h2 id="question-text" class="text-2xl font-bold mb-8"></h2>

          <!-- Answer Options -->
          <div id="answer-options" class="space-y-3 mb-8">
            <!-- Options will be inserted here -->
          </div>

          <!-- Navigation -->
          <div class="flex justify-between">
            <button id="q-back-btn" class="px-6 py-3 bg-zinc-800 text-white rounded-lg hover:bg-zinc-700 transition-colors disabled:opacity-50" disabled>
              ← Back
            </button>
            <button id="q-next-btn" class="px-6 py-3 bg-lime-400 text-black font-semibold rounded-lg hover:bg-lime-500 transition-colors disabled:opacity-50" disabled>
              Next Question →
            </button>
          </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden">
          <div class="bg-zinc-900 border border-zinc-800 rounded-2xl p-8 md:p-12 mb-6">
            <!-- Overall Score -->
            <div class="text-center mb-12">
              <h2 class="text-3xl font-bold mb-2">Your Data Analytics Maturity Level</h2>
              <div id="maturity-level" class="text-6xl font-black text-lime-400 my-6"></div>
              <p id="maturity-description" class="text-xl text-gray-400"></p>
            </div>

            <!-- Dimension Scores -->
            <div class="mb-12">
              <h3 class="text-2xl font-bold mb-6 text-center">Your Scores by Dimension</h3>
              <div class="space-y-6">
                <div id="dimension-results">
                  <!-- Will be populated by JavaScript -->
                </div>
              </div>
            </div>

            <!-- Recommendations -->
            <div class="bg-gradient-to-r from-lime-400/10 to-green-500/10 border border-lime-400/20 rounded-lg p-6 mb-8">
              <h3 class="text-xl font-bold mb-4 flex items-center">
                <Icon name="mdi:lightbulb" class="w-6 h-6 text-lime-400 mr-2" />
                Next Steps for Your Organization
              </h3>
              <div id="recommendations" class="space-y-3 text-gray-300">
                <!-- Will be populated by JavaScript -->
              </div>
            </div>

            <!-- CTA Buttons -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
              <button id="download-btn" class="px-6 py-3 bg-zinc-800 text-white font-semibold rounded-lg hover:bg-zinc-700 transition-colors flex items-center justify-center">
                <Icon name="mdi:download" class="w-5 h-5 mr-2" />
                Download Report
              </button>
              <button id="email-btn" class="px-6 py-3 bg-zinc-800 text-white font-semibold rounded-lg hover:bg-zinc-700 transition-colors flex items-center justify-center">
                <Icon name="mdi:email" class="w-5 h-5 mr-2" />
                Email Results
              </button>
              <a href="/contact" class="px-6 py-3 bg-lime-400 text-black font-semibold rounded-lg hover:bg-lime-500 transition-colors flex items-center justify-center">
                Get Expert Help →
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</BaseLayout>

<script>
  // Assessment Data
  const questions = [
    // Data Infrastructure (4 questions)
    { category: 'Data Infrastructure', question: 'How would you describe your data storage and management infrastructure?', options: [
      { text: 'Mostly spreadsheets and local files', score: 1 },
      { text: 'Basic database with limited integration', score: 2 },
      { text: 'Centralized data warehouse with some automation', score: 3 },
      { text: 'Cloud-based data lake/warehouse with ETL pipelines', score: 4 },
      { text: 'Advanced data fabric with real-time streaming', score: 5 }
    ]},
    { category: 'Data Infrastructure', question: 'How accessible is data across your organization?', options: [
      { text: 'Data is siloed, hard to access', score: 1 },
      { text: 'Limited access, requires IT support', score: 2 },
      { text: 'Self-service for some departments', score: 3 },
      { text: 'Self-service across most of the organization', score: 4 },
      { text: 'Fully democratized with role-based access', score: 5 }
    ]},
    { category: 'Data Infrastructure', question: 'How would you rate your data quality and reliability?', options: [
      { text: 'Inconsistent, often unreliable', score: 1 },
      { text: 'Some quality checks, but issues remain', score: 2 },
      { text: 'Standardized quality processes for critical data', score: 3 },
      { text: 'Automated quality monitoring and alerts', score: 4 },
      { text: 'Comprehensive data quality framework with SLAs', score: 5 }
    ]},
    { category: 'Data Infrastructure', question: 'What level of data integration do you have across systems?', options: [
      { text: 'Minimal or no integration', score: 1 },
      { text: 'Manual data transfers between systems', score: 2 },
      { text: 'Some automated integrations', score: 3 },
      { text: 'Most systems integrated via APIs', score: 4 },
      { text: 'Fully integrated data ecosystem', score: 5 }
    ]},

    // Analytics Capabilities (4 questions)
    { category: 'Analytics Capabilities', question: 'What type of analytics does your organization primarily use?', options: [
      { text: 'Basic reporting and spreadsheets', score: 1 },
      { text: 'Descriptive analytics (what happened)', score: 2 },
      { text: 'Diagnostic analytics (why it happened)', score: 3 },
      { text: 'Predictive analytics (what will happen)', score: 4 },
      { text: 'Prescriptive analytics and AI-driven insights', score: 5 }
    ]},
    { category: 'Analytics Capabilities', question: 'How are insights delivered to decision-makers?', options: [
      { text: 'Manual reports sent periodically', score: 1 },
      { text: 'Static dashboards with limited interactivity', score: 2 },
      { text: 'Interactive dashboards updated regularly', score: 3 },
      { text: 'Real-time dashboards with alerts', score: 4 },
      { text: 'AI-powered insights pushed proactively', score: 5 }
    ]},
    { category: 'Analytics Capabilities', question: 'Do you use advanced analytics or machine learning?', options: [
      { text: 'Not at all', score: 1 },
      { text: 'Exploring or planning to start', score: 2 },
      { text: 'Pilot projects in specific areas', score: 3 },
      { text: 'Production ML models in several use cases', score: 4 },
      { text: 'ML integrated across the organization', score: 5 }
    ]},
    { category: 'Analytics Capabilities', question: 'How quickly can you get answers to new business questions?', options: [
      { text: 'Weeks or months', score: 1 },
      { text: '1-2 weeks', score: 2 },
      { text: 'A few days', score: 3 },
      { text: 'Within a day', score: 4 },
      { text: 'Minutes to hours (self-service)', score: 5 }
    ]},

    // People & Skills (4 questions)
    { category: 'People & Skills', question: 'What data skills exist in your organization?', options: [
      { text: 'Basic Excel skills only', score: 1 },
      { text: 'Some SQL and reporting skills', score: 2 },
      { text: 'Analytics team with BI tools expertise', score: 3 },
      { text: 'Data scientists and engineers on staff', score: 4 },
      { text: 'Center of excellence with diverse data experts', score: 5 }
    ]},
    { category: 'People & Skills', question: 'How does your organization invest in data skills development?', options: [
      { text: 'No formal training programs', score: 1 },
      { text: 'Ad-hoc training when needed', score: 2 },
      { text: 'Regular training for analytics team', score: 3 },
      { text: 'Organization-wide data literacy programs', score: 4 },
      { text: 'Comprehensive continuous learning culture', score: 5 }
    ]},
    { category: 'People & Skills', question: 'Who is responsible for data-driven decision making?', options: [
      { text: 'Only senior leadership', score: 1 },
      { text: 'Department heads with analyst support', score: 2 },
      { text: 'Managers across the organization', score: 3 },
      { text: 'All employees encouraged to use data', score: 4 },
      { text: 'Data literacy expected at all levels', score: 5 }
    ]},
    { category: 'People & Skills', question: 'Do you have a Chief Data Officer or equivalent role?', options: [
      { text: 'No dedicated data leadership', score: 1 },
      { text: 'Data is part of IT leadership', score: 2 },
      { text: 'Analytics manager or director', score: 3 },
      { text: 'VP of Data or Analytics', score: 4 },
      { text: 'CDO with seat at executive table', score: 5 }
    ]},

    // Data Culture (4 questions)
    { category: 'Data Culture', question: 'How are business decisions typically made in your organization?', options: [
      { text: 'Based on intuition and experience', score: 1 },
      { text: 'Mix of intuition and some data', score: 2 },
      { text: 'Data-informed when available', score: 3 },
      { text: 'Data-driven for most decisions', score: 4 },
      { text: 'Data is central to all decisions', score: 5 }
    ]},
    { category: 'Data Culture', question: 'How does leadership view data and analytics?', options: [
      { text: 'Not a priority', score: 1 },
      { text: 'Nice to have for reporting', score: 2 },
      { text: 'Important but not strategic', score: 3 },
      { text: 'Strategic priority with budget', score: 4 },
      { text: 'Core competitive advantage', score: 5 }
    ]},
    { category: 'Data Culture', question: 'How comfortable are employees with using data?', options: [
      { text: 'Most avoid it', score: 1 },
      { text: 'Only analysts use data', score: 2 },
      { text: 'Some departments embrace it', score: 3 },
      { text: 'Widely accepted across organization', score: 4 },
      { text: 'Everyone seeks data to inform work', score: 5 }
    ]},
    { category: 'Data Culture', question: 'How does your organization share insights and learnings from data?', options: [
      { text: 'Rarely or never', score: 1 },
      { text: 'Occasional emails or presentations', score: 2 },
      { text: 'Regular reports to stakeholders', score: 3 },
      { text: 'Dashboards and collaborative platforms', score: 4 },
      { text: 'Active knowledge sharing culture', score: 5 }
    ]},

    // Governance (4 questions)
    { category: 'Governance', question: 'How does your organization manage data privacy and security?', options: [
      { text: 'No formal policies', score: 1 },
      { text: 'Basic IT security only', score: 2 },
      { text: 'Data security policies in place', score: 3 },
      { text: 'Compliance with major regulations (GDPR, etc.)', score: 4 },
      { text: 'Comprehensive privacy and security framework', score: 5 }
    ]},
    { category: 'Governance', question: 'Do you have a data governance framework?', options: [
      { text: 'No governance in place', score: 1 },
      { text: 'Informal data ownership', score: 2 },
      { text: 'Basic governance for critical data', score: 3 },
      { text: 'Formal governance with data stewards', score: 4 },
      { text: 'Mature governance with clear policies', score: 5 }
    ]},
    { category: 'Governance', question: 'How do you maintain data documentation and metadata?', options: [
      { text: 'No documentation', score: 1 },
      { text: 'Scattered in various locations', score: 2 },
      { text: 'Basic data dictionary', score: 3 },
      { text: 'Centralized metadata repository', score: 4 },
      { text: 'Active data catalog with lineage', score: 5 }
    ]},
    { category: 'Governance', question: 'How do you measure the value and impact of data initiatives?', options: [
      { text: 'We don\'t measure it', score: 1 },
      { text: 'Anecdotal evidence only', score: 2 },
      { text: 'Some KPIs for major projects', score: 3 },
      { text: 'Regular ROI tracking', score: 4 },
      { text: 'Comprehensive value measurement framework', score: 5 }
    ]},
  ];

  const maturityLevels = {
    1: { name: 'Initial', description: 'Your organization is in the early stages of data analytics adoption. Focus on building foundations.', color: '#ef4444' },
    2: { name: 'Developing', description: 'You\'re making progress with data analytics but have opportunities for improvement.', color: '#f97316' },
    3: { name: 'Defined', description: 'You have established data analytics processes and are seeing value from your efforts.', color: '#eab308' },
    4: { name: 'Managed', description: 'Your organization has mature data analytics capabilities with measurable impact.', color: '#A3E635' },
    5: { name: 'Optimized', description: 'You\'re a data-driven organization with advanced analytics as a competitive advantage.', color: '#22c55e' }
  };

  // State
  let currentQuestion = 0;
  let answers = [];

  // Elements
  const introScreen = document.getElementById('intro-screen');
  const questionScreen = document.getElementById('question-screen');
  const resultsScreen = document.getElementById('results-screen');
  const startBtn = document.getElementById('start-btn');

  // Start assessment
  startBtn?.addEventListener('click', () => {
    introScreen?.classList.add('hidden');
    questionScreen?.classList.remove('hidden');
    showQuestion(0);
  });

  function showQuestion(index) {
    const q = questions[index];
    currentQuestion = index;

    // Update progress
    const progress = ((index + 1) / questions.length) * 100;
    document.getElementById('q-num')!.textContent = String(index + 1);
    document.getElementById('q-progress')!.textContent = String(Math.round(progress));
    (document.getElementById('q-bar') as HTMLElement).style.width = `${progress}%`;

    // Update question
    document.getElementById('category-name')!.textContent = q.category;
    document.getElementById('question-text')!.textContent = q.question;

    // Update options
    const optionsContainer = document.getElementById('answer-options')!;
    optionsContainer.innerHTML = '';

    q.options.forEach((option, i) => {
      const button = document.createElement('button');
      button.className = 'answer-option w-full p-4 bg-zinc-800 border-2 border-zinc-700 rounded-lg text-left hover:border-lime-400 transition-all';
      button.innerHTML = `
        <div class="flex items-center justify-between">
          <span>${option.text}</span>
          <span class="text-sm text-gray-500">${option.score}/5</span>
        </div>
      `;
      button.addEventListener('click', () => selectAnswer(option.score));

      // Restore previous answer
      if (answers[index] === option.score) {
        button.classList.add('border-lime-400', 'bg-lime-400/10');
      }

      optionsContainer.appendChild(button);
    });

    // Update navigation
    document.getElementById('q-back-btn')!.disabled = index === 0;
    document.getElementById('q-next-btn')!.disabled = !answers[index];
  }

  function selectAnswer(score: number) {
    answers[currentQuestion] = score;

    // Visual feedback
    document.querySelectorAll('.answer-option').forEach(btn => {
      btn.classList.remove('border-lime-400', 'bg-lime-400/10');
    });
    (event?.target as HTMLElement).closest('.answer-option')?.classList.add('border-lime-400', 'bg-lime-400/10');

    // Enable next button
    document.getElementById('q-next-btn')!.disabled = false;
  }

  document.getElementById('q-back-btn')?.addEventListener('click', () => {
    if (currentQuestion > 0) {
      showQuestion(currentQuestion - 1);
    }
  });

  document.getElementById('q-next-btn')?.addEventListener('click', () => {
    if (currentQuestion < questions.length - 1) {
      showQuestion(currentQuestion + 1);
    } else {
      showResults();
    }
  });

  function showResults() {
    questionScreen?.classList.add('hidden');
    resultsScreen?.classList.remove('hidden');

    // Calculate scores by dimension
    const dimensionScores: { [key: string]: { total: number, count: number } } = {};

    questions.forEach((q, i) => {
      if (!dimensionScores[q.category]) {
        dimensionScores[q.category] = { total: 0, count: 0 };
      }
      dimensionScores[q.category].total += answers[i];
      dimensionScores[q.category].count += 1;
    });

    // Calculate average scores
    const avgScores: { [key: string]: number } = {};
    Object.keys(dimensionScores).forEach(dim => {
      avgScores[dim] = dimensionScores[dim].total / dimensionScores[dim].count;
    });

    // Overall maturity
    const overallScore = Object.values(avgScores).reduce((a, b) => a + b, 0) / Object.keys(avgScores).length;
    const maturityLevel = Math.round(overallScore);

    // Display overall score
    const level = maturityLevels[maturityLevel as keyof typeof maturityLevels];
    document.getElementById('maturity-level')!.textContent = level.name;
    document.getElementById('maturity-description')!.textContent = level.description;
    (document.getElementById('maturity-level') as HTMLElement).style.color = level.color;

    // Display dimension scores
    const dimensionResults = document.getElementById('dimension-results')!;
    dimensionResults.innerHTML = '';

    Object.entries(avgScores).forEach(([dimension, score]) => {
      const percentage = (score / 5) * 100;
      const div = document.createElement('div');
      div.innerHTML = `
        <div class="flex justify-between items-center mb-2">
          <span class="font-medium">${dimension}</span>
          <span class="text-lime-400 font-bold">${score.toFixed(1)}/5</span>
        </div>
        <div class="h-3 bg-zinc-800 rounded-full overflow-hidden">
          <div class="h-full bg-gradient-to-r from-lime-400 to-green-500 transition-all duration-1000" style="width: ${percentage}%"></div>
        </div>
      `;
      dimensionResults.appendChild(div);
    });

    // Generate recommendations
    const recommendations = document.getElementById('recommendations')!;
    const recs = generateRecommendations(avgScores, maturityLevel);
    recommendations.innerHTML = recs.map(rec => `<p>✓ ${rec}</p>`).join('');

    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }

  function generateRecommendations(scores: { [key: string]: number }, overall: number): string[] {
    const recs: string[] = [];

    // Find lowest scoring dimension
    const lowest = Object.entries(scores).sort((a, b) => a[1] - b[1])[0];

    if (overall <= 2) {
      recs.push('Start by establishing a centralized data infrastructure with basic quality controls');
      recs.push('Invest in foundational data skills training for your team');
      recs.push('Create a simple data governance framework to ensure security and compliance');
    } else if (overall <= 3) {
      recs.push('Focus on improving your ' + lowest[0] + ' - currently your biggest opportunity area');
      recs.push('Implement self-service analytics tools to democratize data access');
      recs.push('Develop a data strategy roadmap aligned with business objectives');
    } else if (overall <= 4) {
      recs.push('Consider advanced analytics and machine learning for predictive insights');
      recs.push('Build a center of excellence to scale best practices across the organization');
      recs.push('Implement real-time data pipelines and streaming analytics');
    } else {
      recs.push('Explore cutting-edge AI and automation to maintain your competitive advantage');
      recs.push('Share your data-driven culture and learnings with the broader community');
      recs.push('Continuously innovate with emerging technologies like generative AI');
    }

    recs.push('Partner with experts like AUXO Data Labs to accelerate your data analytics journey');

    return recs;
  }

  // Download report (stub)
  document.getElementById('download-btn')?.addEventListener('click', () => {
    alert('PDF download functionality would be implemented here with your backend.');
  });

  // Email results (stub)
  document.getElementById('email-btn')?.addEventListener('click', () => {
    const email = prompt('Enter your email to receive the results:');
    if (email) {
      alert(`Results would be sent to ${email}. This requires backend integration.`);
    }
  });
</script>

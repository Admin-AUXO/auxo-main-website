---
import BaseLayout from "../layouts/BaseLayout.astro";
import Navigation from "../components/common/Navigation.astro";
import { siteData } from "../data/config/site";

// Section Components
import HeroSection from "../components/sections/home/HeroSection.astro";
import ServicesPreview from "../components/sections/home/ServicesPreview.astro";
import StartupAdvantage from "../components/sections/home/StartupAdvantage.astro";
import ValueProposition from "../components/sections/home/ValueProposition.astro";
import MethodologySection from "../components/sections/home/MethodologySection.astro";
import PartnershipSection from "../components/sections/home/PartnershipSection.astro";
import FinalCta from "../components/sections/home/FinalCta.astro";

// Styles
import "../styles/homepage.css";
---

<BaseLayout
  title="Data Analytics Consultancy Dubai, UAE | AUXO Data Labs"
  description={siteData.description}
  showNav={false}
  showParticles={true}
  hideFooterNewsletter={true}
>
  <Navigation />

  <!-- Hero Section -->
  <HeroSection />

  <!-- Full-Width Background Section for Services -->
  <div class="w-full bg-card transition-colors">
    <ServicesPreview />
  </div>

  <!-- Startup Advantages Section -->
  <StartupAdvantage />

  <!-- Full-Width Background Section for Value Proposition -->
  <div class="w-full bg-card transition-colors">
    <ValueProposition />
  </div>

  <!-- Methodology Section -->
  <MethodologySection />

  <!-- Full-Width Background Section for Partnership -->
  <div class="w-full bg-card transition-colors">
    <PartnershipSection />
  </div>

  <!-- Final CTA with Particle Background -->
  <FinalCta />

  <script>
    // Setup homepage animations
    function setupHomepageAnimations() {
      // Run hero animation
      function runHeroAnimation() {
        const heroSection = document.getElementById("hero");
        if (!heroSection) return;
        heroSection.classList.remove("hero-animate");
        heroSection.classList.add("hero-animation-reset");
        void heroSection.offsetWidth;
        heroSection.classList.remove("hero-animation-reset");
        heroSection.classList.add("hero-animate");
      }

      // Setup intersection observer
      function setupIntersectionObserver() {
        const prefersReducedMotion = window.matchMedia(
          "(prefers-reduced-motion: reduce)",
        ).matches;

        if (prefersReducedMotion) {
          document.querySelectorAll(".animate-fade-in").forEach((el) => {
            (el as HTMLElement).style.opacity = "1";
          });
          return;
        }

        const observer = new IntersectionObserver(
          (entries) => {
            entries.forEach((entry) => {
              if (entry.isIntersecting) {
                const element = entry.target as HTMLElement;
                element.style.opacity = "1";
                const delay = element.getAttribute("style");
                if (delay && delay.includes("animation-delay")) {
                  // Delay is already set in style attribute
                }
                observer.unobserve(element);
              }
            });
          },
          {
            threshold: 0.1,
            rootMargin: "0px 0px -50px 0px",
          },
        );

        document.querySelectorAll(".animate-fade-in").forEach((el) => {
          observer.observe(el);
        });
      }

      runHeroAnimation();
      setupIntersectionObserver();
    }

    // Initialize
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", setupHomepageAnimations);
    } else {
      setupHomepageAnimations();
    }

    document.addEventListener("astro:page-load", setupHomepageAnimations);
  </script>
</BaseLayout>

# AUXO Data Labs Website: Comprehensive Technical Guide for AI Agents

---

## PART 1: AGENT ONBOARDING & RULES OF ENGAGEMENT

This part contains the most critical information for you, the AI Coding Agent. **You must read and adhere to these guidelines before making any changes to the codebase.**

### 1. Introduction for AI Coding Agents

Welcome, Agent. Your primary directive is to assist in the development and maintenance of the AUXO Data Labs corporate website. This document is your comprehensive guide to the project. It contains the architecture, components, workflows, and the rules you must follow.

This project is a modern, high-performance static site built with Astro. Your goal is to understand its structure and conventions to make safe, efficient, and consistent changes. Adherence to the guidelines in this document is mandatory for all tasks.

### 2. Guidelines for AI Coding Agents

#### Getting Acquainted

Before making any changes, it is mandatory to familiarize yourself with the project by reading the following documents in order:

1.  **`TECHNICAL_DOCUMENTATION.md`** (this file): Your primary source of truth. Provides a deep dive into the project's architecture, components, and workflows.
2.  **`README.md`**: Offers a high-level overview of the project.

#### Core Principles

-   **Static First:** This is a static site generated by Astro. Prioritize static generation and minimize client-side JavaScript wherever possible.
-   **Component-Based Architecture:** The site is built with reusable Astro components found in `src/components/`. Always look for existing components to reuse before creating new ones.
-   **Data-Driven Content:** Most of the site's content is managed in TypeScript files in `src/data/`. When updating content, this should be your first stop.
-   **TypeScript Everywhere:** The project uses TypeScript for type safety. Ensure all new code is strongly typed.
-   **Utility-First CSS:** The project uses Tailwind CSS. Adhere to its utility-first principles and use the existing design tokens defined in `tailwind.config.js` and `src/styles/global.css`.

#### Development Workflow

1.  **Analyze the Request:** Thoroughly understand the user's request and the context of the required changes.
2.  **Formulate a Plan:** Before writing code, formulate a clear plan. Use the information in this documentation to inform your plan.
3.  **Implement Changes:** Implement the changes, following the project's core principles and coding conventions.
4.  **Run Local Checks:** Before proposing changes, ensure the following commands run successfully:
    -   `npm run lint`: Checks for linting errors.
    -   `npm run check`: Performs TypeScript type checking.
    -   `npm run build`: Ensures the site builds successfully.
5.  **Update Documentation:** If your changes affect the project's architecture, add a new component, or modify an existing one, you must update this `TECHNICAL_DOCUMENTATION.md` file accordingly.

#### Ground Rules

1.  **Propose All Changes for Review:** All code modifications, no matter how small, must be proposed for review. Do not attempt to commit directly.
2.  **Update This Documentation:** It is mandatory to update this `TECHNICAL_DOCUMENTATION.md` file whenever you make changes that alter the project's structure, add new features, or modify existing ones. This ensures that the documentation remains a reliable source of truth for the project.
3.  **Adhere to Existing Conventions:** Mimic the style, structure, and patterns of the existing code. Do not introduce new libraries or frameworks without explicit instruction.

#### Commit Message Guidelines

When proposing changes, use the [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/) specification for the commit message. The format is:

```
<type>[optional scope]: <description>
```

-   **`type`**: Must be one of `feat`, `fix`, `docs`, `style`, `refactor`, `test`, `chore`.
-   **`description`**: A concise summary of the change in the imperative mood.

#### Code Style & Conventions

-   **Comments:** Add comments only when necessary to explain *why* a piece of code is written a certain way, not *what* it does. Avoid obvious comments.
-   **Naming Conventions:**
    -   Components: `PascalCase` (e.g., `MyComponent.astro`)
    -   Variables and functions: `camelCase` (e.g., `myVariable`, `myFunction`)
    -   TypeScript interfaces: `PascalCase` (e.g., `MyInterface`)
-   **Imports:** Keep imports organized at the top of the file, grouped as follows:
    1.  Astro imports
    2.  Third-party library imports
    3.  Internal component imports
    4.  Data imports
    5.  Type imports
-   **Tailwind CSS:** While there is no strict linter for class order, try to follow a consistent pattern (e.g., layout, spacing, typography, colors, effects).

#### Dos and Don’ts (Best Practices)

-   **DO** use the data files in `src/data/` to manage content. This is the primary way to update text, links, and other data on the site.
-   **DO** reuse existing components from `src/components/` whenever possible.
-   **DO** ensure all new components and pages are accessible (a11y) by using semantic HTML and ARIA attributes where necessary. The ESLint configuration will help with this.
-   **DO** use Astro's `getCollection` API to query blog posts from `src/content/blog/`.
-   **DON'T** hard-code strings directly into components or pages. If the text is likely to change, add it to the appropriate file in `src/data/`.
-   **DON'T** duplicate code. If you find yourself writing the same code in multiple places, create a reusable component.
-   **DON'T** add large client-side JavaScript libraries without a very strong justification. This is a static-first site, and performance is a key priority.
-   **DON'T** use `<a>` tags for internal navigation without using the `base` variable. All internal links should be relative to the base URL (e.g., `<a href={base}>Home</a>`).

#### Common "Gotchas" to Avoid

-   **Client-side Scripts:** Remember that Astro components are server-only by default. If you need to add client-side interactivity, you must use a `<script>` tag within the `.astro` file. The existing interactive components like `MultiStepForm.astro` and `MaturityCalculator.astro` are good examples of this pattern.
-   **API Endpoints:** The API endpoints in `src/pages/api/` have comprehensive Zod validation and rate limiting implemented, but are not yet connected to email services. They validate inputs securely and enforce rate limits, but don't send actual emails. Email service integration (SendGrid, AWS SES, etc.) is still required for full functionality.
-   **Base URL:** The project is configured with a `base` URL in `astro.config.mjs`. All internal links and asset paths must be prefixed with the `base` variable to work correctly in both development and production. **Critical:** API calls in client-side scripts must also use the base URL (e.g., `fetch(\`${import.meta.env.BASE_URL}api/contact\`)`).
-   **Image Optimization:** While Astro's image optimization is powerful, be mindful of the image formats and sizes you use. Large, unoptimized images can still slow down the site.
-   **ESLint Configuration:** The project uses ESLint v9 with flat config format (`eslint.config.js`). All linting commands work correctly. Do not revert to the old `.eslintrc.cjs` format.

### 2.5 Conducting Code Audits (Agent Guide)

This section provides comprehensive guidelines for AI agents conducting code audits of the AUXO website. Following these standards ensures consistent, actionable audit reports.

#### Audit Overview

A code audit is a systematic review of the entire codebase to identify issues related to security, functionality, performance, code quality, and best practices. The goal is to produce actionable findings that can be prioritized and addressed systematically.

#### When to Conduct an Audit

-   **Initial onboarding:** When first encountering the codebase
-   **Before major releases:** To ensure production readiness
-   **After significant changes:** To verify no regressions were introduced
-   **Periodic reviews:** Quarterly or bi-annually to maintain code quality
-   **User request:** When explicitly asked to audit the codebase

#### Audit Methodology

Follow this systematic approach for comprehensive audits:

##### 1. Preparation Phase

1. **Read Documentation First:**
   - Read this entire `TECHNICAL_DOCUMENTATION.md` file
   - Review `README.md` for project overview
   - Check git history to understand previous changes and avoid flagging already-resolved issues

2. **Understand the Stack:**
   - Identify all frameworks, libraries, and tools in use
   - Note the Node.js version and package versions
   - Review `package.json` for dependencies
   - Check for deprecated or outdated packages

3. **Set Up Local Environment:**
   - Run `npm install` to install dependencies
   - Run `npm run dev` to verify local development works
   - Run `npm run build` to check for build errors
   - Run `npm run check` for TypeScript errors
   - Run `npm run lint` for linting issues

##### 2. Systematic Review Phase

Audit the codebase in this order for comprehensive coverage:

**A. Critical Security Issues (Priority 1)**

-   **Input Validation:**
  - Check all API endpoints in `src/pages/api/` for input validation
  - Verify Zod schemas exist for all user inputs
  - Look for SQL injection, XSS, and command injection vulnerabilities
  - Check for proper sanitization of user-provided data

-   **Authentication & Authorization:**
  - Review any auth mechanisms
  - Check for exposed credentials or API keys in code
  - Verify `.env` files are in `.gitignore`

-   **Security Headers:**
  - Check `public/_headers` for CSP, X-Frame-Options, HSTS
  - Verify CORS configuration is not overly permissive

-   **Rate Limiting:**
  - Verify API endpoints have rate limiting
  - Check rate limit configurations are appropriate

-   **Dependencies:**
  - Run `npm audit` to check for vulnerable packages
  - Identify outdated packages that need updates

**B. Functional Issues (Priority 2)**

-   **Build Process:**
  - Check for build errors or warnings
  - Verify all imports resolve correctly
  - Test production build: `npm run build && npm run preview`

-   **Configuration Files:**
  - Verify `astro.config.mjs`, `tailwind.config.js`, `tsconfig.json`, `eslint.config.js`
  - Check for deprecated configuration formats
  - Ensure all paths and aliases resolve correctly

-   **API Endpoints:**
  - Test all endpoints in `src/pages/api/`
  - Verify error handling is comprehensive
  - Check for proper HTTP status codes
  - Ensure responses don't expose sensitive information

-   **Client-Side Scripts:**
  - Review all `<script>` tags in `.astro` files
  - Check for DOM query errors (missing null checks)
  - Verify event handlers have error handling
  - Look for memory leaks (unremoved event listeners)

**C. Code Quality Issues (Priority 3)**

-   **TypeScript:**
  - Run `npm run check` and document all type errors
  - Check for excessive use of `any` type
  - Verify interfaces are properly defined

-   **ESLint:**
  - Run `npm run lint` and document violations
  - Check for disabled rules that should be enabled
  - Verify accessibility rules are enforced

-   **Code Duplication:**
  - Identify duplicated logic that should be abstracted
  - Check for copy-pasted components that should be unified

-   **Unused Code:**
  - Look for unused imports, variables, functions
  - Identify dead code paths
  - Check for commented-out code blocks

**D. Performance Issues (Priority 4)**

-   **Bundle Size:**
  - Check for large dependencies that could be tree-shaken
  - Identify opportunities for code splitting
  - Review client-side JavaScript size

-   **Image Optimization:**
  - Check if images use Astro's `<Image />` component
  - Verify images are in modern formats (WebP, AVIF)
  - Look for unoptimized large images

-   **Caching:**
  - Review cache headers in `public/_headers`
  - Check for appropriate cache strategies

**E. Content & Accessibility (Priority 5)**

-   **Accessibility:**
  - Verify semantic HTML usage
  - Check for ARIA attributes where needed
  - Ensure color contrast meets WCAG standards
  - Verify keyboard navigation works

-   **SEO:**
  - Check meta tags are present and correct
  - Verify structured data (JSON-LD) is valid
  - Check for proper heading hierarchy
  - Verify `robots.txt` and sitemap exist

-   **Content Completeness:**
  - Check for placeholder text or Lorem ipsum
  - Verify all data files are populated
  - Look for broken internal links
  - Check for missing images or assets

##### 3. Testing Phase

-   **Manual Testing:**
  - Navigate through all pages in the browser
  - Test all forms and interactive elements
  - Verify responsive design on different screen sizes
  - Test in multiple browsers (Chrome, Firefox, Safari)

-   **Automated Testing:**
  - Run all available npm scripts
  - Check for console errors in browser DevTools
  - Use Lighthouse for performance and accessibility scores

##### 4. Documentation Phase

Document findings using the standard format (see below).

#### Issue Categorization & Prioritization

Classify every issue using these categories:

| Priority | Category | Severity | Examples | Action Required |
|----------|----------|----------|----------|-----------------|
| **P0** | **Critical** | Blocks deployment | Security vulnerabilities, build failures, broken core functionality | Fix immediately |
| **P1** | **High** | Impacts users | Missing validation, no rate limiting, console errors in production, API bugs | Fix before launch |
| **P2** | **Medium** | Quality/UX issues | Missing error handling, poor accessibility, type errors, linting violations | Fix soon |
| **P3** | **Low** | Nice-to-have | Performance optimizations, code duplication, minor UI polish | Fix when time allows |
| **P4** | **Future** | Enhancement | New features, major refactors, content creation | Backlog |

#### Audit Documentation Format

**Always** use the following structure for audit findings documents.

##### Document Structure

```markdown
# [Project Name] - Active Audit Items

**Last Updated:** [Date]
**Project Status:** [Status]
**Critical Issues:** [Status]
**High-Priority Issues:** [Status]

---

## Quick Status

[Brief 2-3 sentence summary of overall project health]

---

## Table of Contents

1. [Critical Items](#1-critical-items)
2. [High-Priority Items](#2-high-priority-items)
3. [Medium-Priority Items](#3-medium-priority-items)
4. [Low-Priority Items](#4-low-priority-items)
5. [Future Enhancements](#5-future-enhancements)

---

## 1. Critical Items

### 1.1 [Issue Name] [Emoji]

**Status:** [Required for Production | Blocks Deployment]
**Priority:** Critical (P0)
**Estimated Time:** [X hours]

**Current State:**
- ✅ [What's working]
- ❌ [What's broken]

**What Needs to Be Done:**

[Detailed description with code examples if needed]

**Option A: [Recommended Approach]**
[Step-by-step implementation guide]

**Option B: [Alternative]**
[Alternative approach with pros/cons]

**Acceptance Criteria:**
- [ ] [Specific, testable criterion 1]
- [ ] [Specific, testable criterion 2]

**Files Affected:**
- `path/to/file.ts:line_number`

---

[Repeat for each issue category]
```

##### Issue Documentation Template

For each issue, include:

1. **Clear Title:** Descriptive name with relevant emoji
2. **Status Tag:** Current state (Required | Recommended | Optional)
3. **Priority Level:** P0-P4 classification
4. **Time Estimate:** Realistic estimate in hours
5. **Current State:** What works vs. what doesn't (with checkboxes)
6. **Detailed Description:** What's wrong and why it matters
7. **Solution Options:** At least one concrete approach with code examples
8. **Acceptance Criteria:** Specific, testable requirements
9. **Files Affected:** Exact file paths and line numbers
10. **Cross-References:** Links to related issues or docs

#### Audit Best Practices

##### DO:

-   ✅ **Read all documentation** before starting the audit
-   ✅ **Run the project locally** to verify issues firsthand
-   ✅ **Prioritize correctly** - Security issues are always critical
-   ✅ **Provide code examples** for recommended fixes
-   ✅ **Include time estimates** for each fix
-   ✅ **Reference specific files and line numbers** for all issues
-   ✅ **Group related issues** under the same category
-   ✅ **Verify issues still exist** before documenting (check git history)
-   ✅ **Provide multiple solution options** when applicable
-   ✅ **Include acceptance criteria** for each issue
-   ✅ **Use consistent formatting** following the standard template
-   ✅ **Create separate historical document** for completed fixes
-   ✅ **Keep audit findings focused** on TODO items only
-   ✅ **Test your findings** - Don't report hypothetical issues
-   ✅ **Consider the deployment environment** (GitHub Pages, Netlify)
-   ✅ **Check for false positives** from automated tools

##### DON'T:

-   ❌ **Don't skip reading existing documentation** - You'll duplicate work
-   ❌ **Don't mix completed and pending items** in the same document
-   ❌ **Don't report issues without verification** - Always test first
-   ❌ **Don't over-prioritize** - Not everything is critical
-   ❌ **Don't under-prioritize security** - Security is always high priority
-   ❌ **Don't provide vague descriptions** like "improve performance"
-   ❌ **Don't forget time estimates** - Planning requires estimates
-   ❌ **Don't skip acceptance criteria** - How else to verify fixes?
-   ❌ **Don't ignore existing patterns** - Follow the project's conventions
-   ❌ **Don't recommend major rewrites** without strong justification
-   ❌ **Don't flag personal preferences** as issues
-   ❌ **Don't create new documentation files** without asking first
-   ❌ **Don't use audit reports as TODO lists** - They're for unresolved issues only
-   ❌ **Don't forget to update audit docs** when issues are fixed

#### Special Considerations for This Project

-   **Astro-Specific Issues:**
  - Check for improper use of client directives (`client:load`, etc.)
  - Verify `getStaticPaths()` is used correctly for dynamic routes
  - Check for hydration mismatches

-   **GitHub Pages Deployment:**
  - Verify all asset paths use `import.meta.env.BASE_URL`
  - Check for hardcoded URLs that won't work with base path
  - Ensure API endpoints work in serverless environment

-   **TypeScript Strict Mode:**
  - This project uses strict TypeScript
  - Flag any `@ts-ignore` or excessive `any` usage

-   **Tailwind CSS:**
  - Check for inline styles that should use Tailwind classes
  - Verify custom colors are in the Tailwind config
  - Look for arbitrary values that could be design tokens

#### Example Audit Workflow

Here's a complete audit workflow example:

```markdown
1. Read TECHNICAL_DOCUMENTATION.md (this file)
2. Review README.md for project overview
3. Check git history for recent changes
4. Run: npm install
5. Run: npm run dev (check for console errors)
6. Run: npm run build (check for build errors)
7. Run: npm run check (TypeScript errors)
8. Run: npm run lint (ESLint violations)
9. Run: npm audit (security vulnerabilities)
10. Review all files in src/pages/api/ for security
11. Review all <script> tags for error handling
12. Check public/_headers for security headers
13. Test all forms and interactive elements
14. Review src/data/ for placeholder content
15. Check for broken links and missing images
16. Test responsive design
17. Run Lighthouse audit
18. Document findings using standard format
19. Create plan with priorities and time estimates
20. Update TECHNICAL_DOCUMENTATION.md if needed
```

#### Creating the Audit Report

After completing the audit, create or update documentation in the `docs/` directory:

1. **Active Audit Findings** - TODO items only
   - Remove any items that have been fixed
   - Focus on remaining work
   - Use the standard template above

2. **Completed Fixes** - Historical record
   - Document what was fixed and when
   - Include commit hashes
   - List files created/modified

3. **Audit Summary** - Executive overview
   - One-page summary for stakeholders
   - High-level status
   - Production readiness assessment

#### Post-Audit Actions

After documenting findings:

1. **Prioritize fixes** based on P0-P4 classification
2. **Create implementation plan** with time estimates
3. **Get user approval** before making changes
4. **Fix issues systematically** starting with P0
5. **Test thoroughly** after each fix
6. **Update documentation** as you go
7. **Mark items complete** in audit findings
8. **Move completed items** to historical fixes document
9. **Commit changes** with clear commit messages
10. **Update this documentation** if new patterns emerge

---

## PART 2: THE BIG PICTURE: ARCHITECTURE & DESIGN

This part covers the high-level overview of the project, including its structure and visual identity.

### 3. Detailed Project Architecture

This section provides a file-level overview of the project structure to prevent the creation of unnecessary or misplaced files.

-   **`/` (Root)**
    -   `astro.config.mjs`: Main Astro configuration file. Controls integrations like Tailwind, MDX, and sitemaps.
    -   `tailwind.config.js`: Configuration for the Tailwind CSS framework.
    -   `tsconfig.json`: TypeScript configuration.
    -   `eslint.config.js`: ESLint v9 flat configuration for code quality and style.
-   **`src/`**: Contains all source code.
    -   **`components/`**: Reusable Astro components.
        -   `Navigation.astro`, `Footer.astro`: The main site header and footer.
        -   `MultiStepForm.astro`, `MaturityCalculator.astro`: Large, interactive components with client-side scripts.
        -   `SEO.astro`, `Breadcrumbs.astro`, `FAQSchema.astro`: SEO and structured data components.
        -   `CookieConsent.astro`: The GDPR/PDPL compliant cookie banner.
        -   `DevBar.astro`: A development-only toolbar for debugging.
    -   **`content/`**: Manages content collections via Astro's API.
        -   `config.ts`: Defines the schema for all content collections (currently only `blog`).
        -   `blog/`: Contains the individual blog post files in MDX format.
    -   **`data/`**: Centralized TypeScript files for site-wide data.
        -   `site.ts`: Global site information (name, contact details).
        -   `services.ts`: Data for the services pages.
        -   `team.ts`: Data for the team members section.
        -   `faq.ts`: Data for the FAQ page.
    -   **`layouts/`**: Defines the main page structure.
        -   `BaseLayout.astro`: The primary layout, including the `<head>`, `<body>`, and slots for page content. It imports the `Navigation`, `Footer`, and `SEO` components.
        -   `LegalLayout.astro`: A specific layout for legal pages like the privacy policy.
    -   **`pages/`**: Represents the site's routes.
        -   `index.astro`: The homepage.
        -   `about.astro`, `contact.astro`, `faq.astro`: Standard static pages.
        -   `blog/index.astro`, `blog/[slug].astro`: The blog listing page and the dynamic template for individual blog posts.
        -   `services/index.astro`, `services/[id].astro`: The services listing page and the dynamic template for individual service pages.
        -   `api/contact.ts`, `api/newsletter.ts`: Server-side API endpoints with Zod validation and rate limiting.
    -   **`styles/`**: Contains global CSS.
        -   `global.css`: Defines global styles, CSS variables for the color palette, and custom animations.
    -   **`utils/`**: Utility functions and shared code.
        -   `validation.ts`: Zod validation schemas for forms (contact and newsletter).
        -   `rateLimit.ts`: Rate limiting utility for API endpoints with configurable presets.
-   **`public/`**: Stores static assets that are copied directly to the build output.
    -   `robots.txt`, `favicon.svg`, `logo.svg`, `brochure.pdf`, etc.
    -   `_headers`: Security headers configuration for Netlify deployment (CSP, X-Frame-Options, HSTS).
-   **`.github/workflows/`**: Contains CI/CD workflows.
    -   `deploy.yml`: Deploys the `master` branch to GitHub Pages (Production).
    -   `deploy-staging.yml`: Deploys `develop` and `staging` branches to Netlify (Staging).

### 4. Branding and Design Guidelines

This section outlines the visual identity of the AUXO Data Labs website.

#### Logo

-   **Design:** The logo is a distinctive 2x2 grid featuring the letters A-U-X-O.
-   **Location:** `public/logo.svg`

#### Color Palette

-   **Source:** The color scheme is defined as CSS variables in `src/styles/global.css`.
-   **Compliance:** The palette is designed for high contrast and readability (WCAG AA/AAA compliant).

| Role                 | Variable Name        | Hex Code  | Usage                               |
|----------------------|----------------------|-----------|-------------------------------------|
| **Primary Accent**   | `--accent-green`     | `#A3E635` | CTAs, links, highlights, icons      |
| **Background**       | `--bg-primary`       | `#000000` | Main page background                |
| **Primary Text**     | `--text-primary`     | `#FFFFFF` | Main body text                      |
| **Secondary Text**   | `--text-secondary`   | `#A0A0A` | Subheadings, less important text    |

#### Typography

-   **Source:** Fonts are defined in `src/styles/global.css` and loaded from Google Fonts in `src/components/SEO.astro`.
-   **Brand/Logo:** `Montserrat` (Weight: 900)
-   **Headings:** `Space Grotesk` (Weights: 600, 700, 800)
-   **Body:** `Inter` (Weights: 400, 500, 600, 700)

#### Iconography

-   **Primary Library:** The project uses [Material Design Icons](https://materialdesignicons.com/) via the `astro-icon` integration for most UI icons.
-   **Technology Icons:** The homepage technology section uses [Simple Icons Font](https://github.com/simple-icons/simple-icons-font) loaded via CDN for brand/technology logos.
-   **Configuration:** The list of included MDI icons is managed in `astro.config.mjs` to optimize bundle size.
-   **Important:** Simple Icons CDN stylesheet must be included in pages that use technology icons (currently: `index.astro`).

---

## PART 3: THE BUILDING BLOCKS: COMPONENTS & DATA

This part is a detailed reference for the project's reusable components and data structures.

### 5. Detailed Component Reference

#### `SEO.astro`

-   **Location:** `src/components/SEO.astro`
-   **Purpose:** Manages all SEO-related meta tags and structured data for a given page.
-   **Props:**

| Prop           | Type         | Default                                                                                             |
|----------------|--------------|-----------------------------------------------------------------------------------------------------|
| `title`        | `string`     | `AUXO Data Labs | Dubai Analytics Consultancy`                                                         |
| `description`  | `string`     | `Leading analytics consultancy in Dubai, UAE...`                                                    |

#### `Breadcrumbs.astro`

-   **Location:** `src/components/Breadcrumbs.astro`
-   **Purpose:** Renders breadcrumb navigation and the corresponding `BreadcrumbList` structured data.
-   **Props:**

| Prop    | Type                          | Default     |
|---------|-------------------------------|-------------|
| `items` | `BreadcrumbItem[]`            | `[]`        |

-   **`BreadcrumbItem` Interface:**

    ```typescript
    export interface BreadcrumbItem {
      label: string;
      href?: string;
    }
    ```

### 6. Code Walkthrough: Maturity Calculator

-   **Location:** `src/pages/maturity-calculator.astro`

This section provides a detailed walkthrough of the calculator's client-side script.

#### State Management

The calculator's state is managed by two simple variables:

-   `currentQuestion`: A number that tracks the index of the current question being displayed.
-   `answers`: An array of numbers that stores the user's selected score for each question.

#### Core Logic

1.  **Initialization:** The script waits for the user to click the "Start Assessment" button, then calls `showQuestion(0)`.
2.  **`showQuestion(index)`:** This function renders the question, category, and answer options. It attaches a click listener to each answer button that calls `selectAnswer(score)`.
3.  **`selectAnswer(score)`:** This function stores the selected score in the `answers` array and enables the "Next" button.
4.  **`showResults()`:** After the last question, this function calculates and displays the overall score, dimension scores, and personalized recommendations based on the `answers` array.

### 7. Content Schemas & Data Structures

#### Blog Collection Schema

-   **File:** `src/content/config.ts`
-   **Collection:** `blog`
-   **Schema (Zod):**

| Field         | Type         | Required | Default |
|---------------|--------------|----------|---------|
| `title`       | `string`     | Yes      |         |
| `description` | `string`     | Yes      |         |
| `publishDate` | `date`       | Yes      |         |

#### Services Data Structure

-   **File:** `src/data/services.ts`
-   **Structure:** An array of objects, where each object represents a service.

```typescript
export const services = [
  {
    id: string,
    title: string,
    description: string,
    icon: string, // mdi:icon-name
    features: string[],
    deliverables: string[],
  },
  // ...
];
```

---

## PART 4: THE MECHANICS: WORKFLOWS & INTEGRATIONS

This part covers the "how-to" aspects of the project.

### 8. Content Management Workflow

#### Adding a New Blog Post

1.  Create a new `.md` or `.mdx` file in `src/content/blog/`.
2.  Add the required frontmatter, following the schema in `src/content/config.ts`.

#### Adding or Modifying a Service

1.  Open `src/data/services.ts`.
2.  Add or edit an object in the `services` array.

### 9. API Endpoints & Data Flow

The project includes two secured API endpoints in `src/pages/api/` with comprehensive validation and rate limiting.

#### `/api/contact`

-   **Purpose:** Handles submissions from the multi-step contact form.
-   **Security:**
    - Zod validation for all inputs (name, email, company, message)
    - Honeypot field for spam detection
    - Rate limiting: 3 requests per 30 minutes per IP
    - Environment-gated logging (dev only)
-   **Validation Rules:**
    - Name: 2-100 characters, letters/spaces/hyphens only
    - Email: RFC-compliant format, max 255 characters
    - Company: 2-200 characters (optional)
    - Message: 10-5000 characters
-   **Response Codes:**
    - 200: Success
    - 400: Validation error (with field-specific messages)
    - 429: Rate limit exceeded (with Retry-After header)
    - 500: Server error
-   **Data Flow:** `MultiStepForm.astro` -> `POST /api/contact` -> `contact.ts` -> Validation -> Rate Limit Check -> (TODO: Email Service)

#### `/api/newsletter`

-   **Purpose:** Handles submissions from the newsletter signup form.
-   **Security:**
    - Zod validation for email and consent
    - Rate limiting: 2 requests per hour per IP
    - Environment-gated logging (dev only)
-   **Validation Rules:**
    - Email: RFC-compliant format, max 255 characters
    - Consent: Must be true
-   **Response Codes:**
    - 200: Success
    - 400: Validation error
    - 429: Rate limit exceeded
    - 500: Server error
-   **Data Flow:** `Footer.astro` -> `POST /api/newsletter` -> `newsletter.ts` -> Validation -> Rate Limit Check -> (TODO: Email Marketing Platform)

#### Rate Limiting Implementation

Located in `src/utils/rateLimit.ts`:
- In-memory rate limiter for serverless compatibility
- Configurable presets for different endpoints
- Automatic cleanup of expired entries
- Returns proper HTTP 429 responses with Retry-After headers
- Extracts client IP from various proxy headers (Cloudflare, Nginx, etc.)

**Presets:**
- `CONTACT`: 3 requests per 30 minutes
- `NEWSLETTER`: 2 requests per hour
- `STRICT`: 3 requests per 15 minutes
- `STANDARD`: 5 requests per 15 minutes
- `RELAXED`: 10 requests per 15 minutes

### 10. Deployment Workflow

The project uses GitHub Actions for CI/CD, located in `.github/workflows/`.

-   **Production (`deploy.yml`):** Pushing to the `master` branch deploys to **GitHub Pages**.
-   **Staging (`deploy-staging.yml`):** Pushing to `develop` or `staging` branches deploys to **Netlify**.

### 11. SEO & Structured Data

-   **`SEO.astro` Component:** The central hub for all SEO-related settings.
-   **Structured Data:** The site uses JSON-LD for `Organization`, `LocalBusiness`, `WebSite`, `BlogPosting`, `BreadcrumbList`, and `FAQPage` schemas.
-   **`robots.txt`**: Located in `public/`, it allows all crawlers except for the `/api/` directory.

### 12. Development & Tooling

-   **ESLint:** The configuration in `eslint.config.js` uses ESLint v9 flat config format and enforces Astro best practices and accessibility standards via `eslint-plugin-astro` and `eslint-plugin-jsx-a11y`.
-   **TypeScript:** Full type checking enabled via `@astrojs/check` and `typescript`.
-   **Validation:** Zod schemas in `src/utils/validation.ts` ensure type-safe form data validation.
-   **`DevBar.astro`:** A development-only toolbar with tools for debugging, accessibility testing, and cache clearing.

### 12.5 Security Features

The project implements multiple layers of security for forms and API endpoints:

#### Input Validation (Zod)

-   **Location:** `src/utils/validation.ts`
-   **Schemas:**
    - `contactFormSchema`: Validates contact form submissions
    - `newsletterSchema`: Validates newsletter signups
-   **Features:**
    - Type-safe validation with detailed error messages
    - Length constraints to prevent abuse
    - Format validation (email, name patterns)
    - Honeypot field for spam detection
    - Sanitization of special characters

#### Rate Limiting

-   **Location:** `src/utils/rateLimit.ts`
-   **Implementation:** In-memory sliding window rate limiter
-   **Features:**
    - Configurable limits per endpoint
    - IP-based tracking
    - Automatic cleanup of expired entries
    - Proper HTTP 429 responses with Retry-After headers
    - Support for various proxy headers (Cloudflare, Nginx)

#### Security Headers

-   **Location:** `public/_headers`
-   **Deployment:** Netlify (automatic), GitHub Pages (requires manual configuration)
-   **Headers Configured:**
    - **Content-Security-Policy (CSP):** Restricts resource loading to trusted sources
    - **X-Frame-Options:** Prevents clickjacking (DENY)
    - **X-Content-Type-Options:** Prevents MIME-type sniffing (nosniff)
    - **X-XSS-Protection:** Enables browser XSS protection
    - **Strict-Transport-Security (HSTS):** Enforces HTTPS (1 year, includeSubDomains, preload)
    - **Referrer-Policy:** Controls referrer information (strict-origin-when-cross-origin)
    - **Permissions-Policy:** Restricts browser features (geolocation, microphone, camera disabled)

#### Environment-Based Logging

-   Console.log statements only execute in development mode
-   Production logs use console.error for actual errors only
-   Sensitive data (passwords, full messages) never logged

### 13. Environment Variables

-   **Source:** The `.env.example` file provides a template for all required variables.
-   **Key Variables:** `PUBLIC_SITE_URL`, `PUBLIC_GOOGLE_ANALYTICS_ID`, `MAILCHIMP_API_KEY`, `SENDGRID_API_KEY`.

---

## APPENDIX: Quick Reference

### File Locations Quick Reference
-   **Homepage:** `src/pages/index.astro`
-   **Navigation:** `src/components/Navigation.astro`
-   **Footer:** `src/components/Footer.astro`
-   **SEO:** `src/components/SEO.astro`
-   **Base Layout:** `src/layouts/BaseLayout.astro`
-   **Site Data:** `src/data/site.ts`
-   **Services Data:** `src/data/services.ts`
-   **Global Styles:** `src/styles/global.css`
-   **Validation Schemas:** `src/utils/validation.ts`
-   **Rate Limiting:** `src/utils/rateLimit.ts`
-   **Security Headers:** `public/_headers`
-   **Astro Config:** `astro.config.mjs`
-   **Tailwind Config:** `tailwind.config.js`
-   **TypeScript Config:** `tsconfig.json`
-   **ESLint Config:** `eslint.config.js`

### Common Commands
```bash
npm run dev          # Start development server
npm run build        # Build for production
npm run preview      # Preview production build
npm run lint         # Run ESLint v9 with flat config
npm run lint:fix     # Auto-fix linting issues
npm run check        # Type check with Astro and TypeScript
```

### Base URL Usage
```astro
---
const base = import.meta.env.BASE_URL;
---
<a href={`${base}about`}>About</a>
<img src={`${base}logo.svg`} />
<script>
  fetch(`${import.meta.env.BASE_URL}api/contact`, { ... });
</script>
```

---

**Last Updated:** 2025-11-01
**Document Version:** 2.3
**Project Status:** Active Development - Production Ready
**Recent Updates:**
- Added comprehensive audit guidelines for AI agents (Section 2.5)
- Documented audit methodology, best practices, and documentation format
- Created standard templates for audit reports
- Fixed all critical and high-priority security issues from audit
- Implemented Zod validation and rate limiting for API endpoints
- Added comprehensive security headers
- Migrated to ESLint v9 flat config
- All dependencies installed and functional
- Build process verified and stable

---
import { Icon } from "astro-icon/components";
import {
  homepageContent,
  type HomepageContent,
} from "../../../data/content/homepage";
import Button from "../../ui/Button.astro";

const content: HomepageContent["hero"] = homepageContent.hero;
const base = import.meta.env.BASE_URL;
---

<section
  id="hero"
  class="relative h-screen flex flex-col items-center justify-center overflow-hidden pt-0 pb-6 sm:pb-8"
>
  <!-- Hero Content Container -->
  <div
    class="container mx-auto px-4 sm:px-6 relative z-10 flex-1 flex flex-col items-center justify-center"
  >
    <div class="w-full max-w-6xl mx-auto text-center">
      <!-- New in Dubai Badge with Typing Animation -->
      {content.badge && (
        <div class="mb-4 sm:mb-6 animate-fade-in -mt-4 sm:-mt-6">
          <div class="typing-badge typing-enhanced">
            <span id="typing-text" class="text-xs sm:text-sm font-bold text-accent-green tracking-wider uppercase" style="font-family: var(--font-body);"></span>
          </div>
        </div>
      )}

      <!-- Logo Animation Container -->
      <div class="mb-6 sm:mb-8">
        <div class="logo-grid w-36 md:w-48 lg:w-56 mx-auto">
          <div class="logo-tile">
            <span class="logo-char">A</span>
          </div>
          <div class="logo-tile">
            <span class="logo-char">U</span>
          </div>
          <div class="logo-tile">
            <span class="logo-char">X</span>
          </div>
          <div class="logo-tile">
            <span class="logo-char">O</span>
          </div>
        </div>
      </div>

      <!-- Brand Text -->
      <div class="logo-caption mb-4 sm:mb-6">
        <h1
          class="text-2xl md:text-3xl lg:text-4xl xl:text-5xl font-extrabold mb-2 text-primary tracking-tight transition-colors"
          style="font-family: var(--font-display);"
        >
          Data Labs
        </h1>
        <p
          class="tagline text-base md:text-lg lg:text-xl text-accent-green font-semibold italic transition-colors"
          style="font-family: var(--font-display);"
        >
          Look Beyond Data
        </p>
      </div>

      <!-- Main Headline -->
      <div class="hero-headline mb-5 sm:mb-6">
        <h2
          class="text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold leading-tight text-primary transition-colors mb-2"
          style="font-family: var(--font-display);"
        >
          <span class="block">{content.title}</span>
          <span class="block text-accent-green mt-1">{content.titleHighlight}</span>
        </h2>
      </div>

      <!-- CTA Buttons -->
      <div class="hero-cta mb-4 sm:mb-6 animate-fade-in" style="animation-delay: 0.8s;">
        <div class="flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4">
          {content.primaryCta.text && (
            <Button
              variant="primary"
              size="md"
              href={`${base}${content.primaryCta.href}/`}
              class="w-full sm:w-auto font-bold shadow-lg shadow-accent-green/20"
            >
              {content.primaryCta.text}
              <Icon name="mdi:arrow-right" class="w-5 h-5" />
            </Button>
          )}
          {content.secondaryCta.text && (
            <Button
              variant="outline"
              size="md"
              href={`${base}${content.secondaryCta.href}/`}
              class="w-full sm:w-auto font-bold"
            >
              {content.secondaryCta.text}
              <Icon name="mdi:chart-line" class="w-5 h-5" />
            </Button>
          )}
        </div>
      </div>

      <!-- Scroll Indicator -->
      <div class="relative z-10 flex flex-col items-center animate-fade-in mt-8 sm:mt-12" style="animation-delay: 1.2s;">
        <a
          href="#services"
          class="flex flex-col items-center text-secondary hover:text-accent-green transition-colors group"
          aria-label={content.scrollIndicator}
        >
          <span class="text-xs mb-1 font-medium uppercase tracking-wider" style="font-family: var(--font-body);">{content.scrollIndicator}</span>
          <div class="animate-bounce">
            <Icon
              name="mdi:chevron-down"
              class="w-4 h-4 group-hover:scale-110 transition-transform"
            />
          </div>
        </a>
      </div>
    </div>
  </div>
</section>

<script>
  // Typing animation for "New in Dubai" badge
  (function initTypingAnimation() {
    const typingText = document.getElementById('typing-text');
    if (!typingText) return;

    const text = 'HELLO WORLD!';
    let charIndex = 0;
    let isDeleting = false;
    let typingSpeed = 100; // ms per character

    function type() {
      if (!typingText) return;
      const currentText = text.substring(0, charIndex);
      typingText.textContent = currentText;

      if (!isDeleting && charIndex < text.length) {
        charIndex++;
        setTimeout(type, typingSpeed);
      } else if (isDeleting && charIndex > 0) {
        charIndex--;
        setTimeout(type, typingSpeed / 2);
      } else if (charIndex === text.length) {
        // Wait before deleting
        setTimeout(() => {
          isDeleting = true;
          type();
        }, 2000);
      } else if (charIndex === 0 && isDeleting) {
        // Wait before typing again
        isDeleting = false;
        setTimeout(type, 500);
      }
    }

    // Start typing after a short delay
    setTimeout(type, 500);
  })();
</script>

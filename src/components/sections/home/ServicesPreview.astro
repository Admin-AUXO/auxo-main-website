---
// Third-party
import { Icon } from "astro-icon/components";

// Internal Components
import SectionContainer from "../../layouts/SectionContainer.astro";

// Data
import { services } from "../../../data/collections/services";
import {
  homepageContent,
  type HomepageContent,
} from "../../../data/content/homepage";

// Utils
import { createUrl } from "../../../utils/url";

const content: HomepageContent["servicesPreview"] = homepageContent.servicesPreview;

---

<SectionContainer id="services" padding="lg" class="relative">
  <div class="container mx-auto responsive-padding">
    <div class="max-w-7xl mx-auto">
      <!-- Section Header -->
      <div class="text-center mb-12 sm:mb-16 md:mb-20 animate-fade-in">
        <div
          class="inline-block mb-4 sm:mb-6 px-4 sm:px-5 py-2 sm:py-2.5 bg-accent-green/10 border border-accent-green rounded-full backdrop-blur-sm"
        >
          <span
            class="text-accent-green text-xs font-bold tracking-wider uppercase"
            style="font-family: var(--font-body);"
            >{content.badge}</span
          >
        </div>
        <h2
          class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-extrabold mb-6 sm:mb-8 text-primary transition-colors leading-[1.3] tracking-tight px-2"
          style="font-family: var(--font-display);"
        >
          {content.title} <span class="text-gradient-green block mt-2 sm:mt-3 pb-1"
            >{content.titleHighlight}</span
          >
        </h2>
        <p
          class="text-base sm:text-lg md:text-xl lg:text-2xl text-secondary max-w-4xl mx-auto leading-relaxed transition-colors font-normal px-2"
          style="font-family: var(--font-body);"
        >
          {content.subtitle}
        </p>
      </div>

      <!-- Services Grid - Matching Main Services Page Design -->
      <div
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5 md:gap-6 lg:gap-8 max-w-7xl mx-auto mb-8 sm:mb-12"
      >
        {
          (() => {
            const serviceOrder = ['data-strategy', 'data-engineering', 'business-intelligence'];
            return services
              .filter(service => serviceOrder.includes(service.id))
              .sort((a, b) => serviceOrder.indexOf(a.id) - serviceOrder.indexOf(b.id));
          })().map((service) => {
            return (
              <a
                href={createUrl(`services/${service.id}`)}
                class="group bg-card border-2 border-theme rounded-2xl p-5 sm:p-6 md:p-8 hover:border-accent-green transition-all duration-normal hover:transform hover:-translate-y-1 relative min-h-[200px] sm:min-h-[220px] flex flex-col"
                aria-label={`Learn more about ${service.title}`}
              >
                  <!-- Badges Container -->
                  <div class="absolute top-3 right-3 z-content flex flex-row gap-2 items-center">
                    {service.complexity && (
                      <div class="bg-accent-green/20 text-accent-green text-xs font-semibold px-2 py-1 rounded-full border border-accent-green backdrop-blur-sm flex items-center gap-1.5">
                        {service.complexity === 'Beginner-Friendly' && (
                          <Icon name="mdi:check-circle" class="w-3 h-3" />
                        )}
                        {service.complexity === 'Intermediate' && (
                          <Icon name="mdi:minus" class="w-3 h-3" />
                        )}
                        {service.complexity === 'Enterprise-Level' && (
                          <Icon name="mdi:star" class="w-3 h-3" />
                        )}
                        <span>{service.complexity}</span>
                      </div>
                    )}
                    {service.timeline && (
                      <div class="bg-accent-green/20 text-accent-green text-xs font-semibold px-2 py-1 rounded-full border border-accent-green backdrop-blur-sm flex items-center gap-1.5">
                        <Icon name="mdi:clock" class="w-3 h-3" />
                        <span>{service.timeline}</span>
                      </div>
                    )}
                  </div>

                  <!-- Icon and Title Row -->
                  <div class="flex items-center gap-2 sm:gap-3 mt-6 md:mt-8 mb-5 md:mb-6">
                    <div class="w-11 h-11 sm:w-12 sm:h-12 md:w-14 md:h-14 bg-accent-green/10 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-accent-green/20 transition-colors -ml-3">
                      <Icon
                        name={service.icon}
                        class="w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 text-accent-green transition-colors"
                      />
                    </div>
                    <h3 class="flex-1 text-base sm:text-lg md:text-xl font-bold group-hover:text-accent-green transition-colors tracking-tight text-primary">
                      {service.title}
                    </h3>
                  </div>

                  <p class="text-secondary mb-4 sm:mb-5 text-sm sm:text-base leading-relaxed line-clamp-3 md:line-clamp-4 lg:line-clamp-none transition-colors flex-grow">
                    {service.description}
                  </p>
                    
                  <div class="flex items-center text-accent-green font-bold text-sm sm:text-base transition-colors mt-auto pt-2">
                    Learn more
                    <svg
                      class="w-4 h-4 sm:w-5 sm:h-5 ml-2 group-hover:translate-x-1 transition-transform"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                      aria-hidden="true"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M9 5l7 7-7 7"
                      />
                    </svg>
                  </div>
              </a>
            );
          })
        }
      </div>

      <!-- View All Button -->
      <div class="text-center">
        <a
          href={createUrl('services')}
          class="group inline-flex items-center justify-center gap-3 px-6 sm:px-8 py-3 sm:py-4 bg-surface/80 backdrop-blur-sm border-2 border-theme text-primary rounded-xl hover:border-accent-green/60 hover:bg-accent-green/10 transition-all duration-normal font-semibold min-h-[48px] sm:min-h-[52px] hover:shadow-lg hover:shadow-accent-green/20 hover:-translate-y-1 w-full sm:w-auto"
          aria-label="View all services"
        >
          <span style="font-family: var(--font-body);" class="text-sm sm:text-base">{content.viewAllText}</span>
          <Icon 
            name="mdi:arrow-right" 
            class="w-5 h-5 transition-transform duration-normal group-hover:translate-x-1"
            aria-hidden="true"
          />
        </a>
      </div>
    </div>
  </div>
</SectionContainer>

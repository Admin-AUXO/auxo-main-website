---
/**
 * Button Component
 * 
 * Reusable button component with theme-aware styling and WCAG AA compliant states.
 * Supports primary, secondary, tertiary (ghost), and outline variants.
 * 
 * @example
 * <Button variant="primary">Click me</Button>
 * <Button variant="secondary" disabled>Disabled</Button>
 * <Button variant="outline" href="/contact">Link Button</Button>
 */

export interface Props {
  variant?: 'primary' | 'secondary' | 'tertiary' | 'ghost' | 'outline';
  size?: 'sm' | 'md' | 'lg';
  disabled?: boolean;
  href?: string;
  target?: string;
  rel?: string;
  type?: 'button' | 'submit' | 'reset';
  class?: string;
  ariaLabel?: string;
}

const {
  variant = 'primary',
  size = 'md',
  disabled = false,
  href,
  target,
  rel,
  type = 'button',
  class: className = '',
  ariaLabel,
} = Astro.props;

// Size configurations
const sizeClasses = {
  sm: 'px-4 py-2 text-sm min-h-[44px]',
  md: 'px-6 py-3 text-base sm:text-lg min-h-[44px]',
  lg: 'px-8 py-4 text-lg sm:text-xl min-h-[56px]',
};

// Variant base classes
const variantClasses = {
  primary: 'btn-primary',
  secondary: 'btn-secondary',
  tertiary: 'btn-ghost',
  ghost: 'btn-ghost',
  outline: 'btn-outline',
};

const baseClasses = `
  inline-flex items-center justify-center gap-2
  font-semibold rounded-lg
  transition-all duration-200
  focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-accent-green focus-visible:ring-offset-2
  disabled:opacity-50 disabled:cursor-not-allowed disabled:pointer-events-none
  touch-manipulation
  ${sizeClasses[size]}
  ${variantClasses[variant]}
  ${className}
`;

// Use anchor tag if href is provided, otherwise use button
const Tag = href ? 'a' : 'button';
const tagProps = href
  ? {
      href: disabled ? undefined : href,
      target,
      rel: target === '_blank' ? 'noopener noreferrer' : rel,
    }
  : {
      type,
      disabled,
    };
---

<Tag
  class={baseClasses}
  aria-label={ariaLabel}
  aria-disabled={disabled ? 'true' : undefined}
  {...tagProps}
>
  <slot />
</Tag>

<style>
  /* ============================================
     BUTTON COMPONENT STYLES
     Theme-aware button variants with WCAG AA compliant states
     ============================================ */

  /* Base button reset */
  .btn-primary,
  .btn-secondary,
  .btn-ghost,
  .btn-outline {
    border: 1px solid transparent;
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
    position: relative;
    contain: layout style paint;
  }

  /* Focus ring - visible and accessible */
  .btn-primary:focus-visible,
  .btn-secondary:focus-visible,
  .btn-ghost:focus-visible,
  .btn-outline:focus-visible {
    outline: 2px solid var(--accent-green);
    outline-offset: 2px;
    box-shadow: 0 0 0 3px var(--accent-green-dim);
  }

  /* ============================================
     PRIMARY BUTTON (Green Accent)
     ============================================ */
  .btn-primary {
    background-color: var(--btn-primary-bg);
    color: var(--btn-primary-text);
    box-shadow: var(--btn-primary-shadow);
  }

  .btn-primary:hover:not(:disabled) {
    background-color: var(--btn-primary-bg-hover);
    box-shadow: var(--btn-primary-shadow-hover);
    transform: translateY(-1px);
  }

  .btn-primary:active:not(:disabled) {
    background-color: var(--btn-primary-bg-active);
    transform: translateY(0);
    box-shadow: var(--btn-primary-shadow);
  }

  .btn-primary:disabled {
    background-color: var(--btn-primary-bg-disabled);
    color: var(--btn-primary-text-disabled);
    box-shadow: none;
  }

  /* ============================================
     SECONDARY BUTTON (Surface)
     ============================================ */
  .btn-secondary {
    background-color: var(--btn-secondary-bg);
    color: var(--btn-secondary-text);
    border-color: var(--btn-secondary-border);
    box-shadow: var(--btn-secondary-shadow);
  }

  .btn-secondary:hover:not(:disabled) {
    background-color: var(--btn-secondary-bg-hover);
    border-color: var(--btn-secondary-border-hover);
    transform: translateY(-1px);
  }

  .btn-secondary:active:not(:disabled) {
    background-color: var(--btn-secondary-bg-active);
    transform: translateY(0);
  }

  .btn-secondary:disabled {
    background-color: var(--btn-secondary-bg-disabled);
    color: var(--btn-secondary-text-disabled);
    border-color: var(--border-color);
    box-shadow: none;
  }

  /* ============================================
     GHOST/TERTIARY BUTTON (Transparent)
     ============================================ */
  .btn-ghost {
    background-color: var(--btn-ghost-bg);
    color: var(--btn-ghost-text);
    border-color: var(--btn-ghost-border);
  }

  .btn-ghost:hover:not(:disabled) {
    background-color: var(--btn-ghost-bg-hover);
    color: var(--btn-ghost-text-hover);
    border-color: var(--btn-ghost-border-hover);
  }

  .btn-ghost:active:not(:disabled) {
    background-color: var(--btn-ghost-bg-active);
  }

  .btn-ghost:disabled {
    color: var(--text-tertiary);
    opacity: 0.5;
  }

  /* ============================================
     OUTLINE BUTTON (Bordered)
     ============================================ */
  .btn-outline {
    background-color: var(--btn-outline-bg);
    color: var(--btn-outline-text);
    border-color: var(--btn-outline-border);
    border-width: 2px;
  }

  .btn-outline:hover:not(:disabled) {
    background-color: var(--btn-outline-bg-hover);
    border-color: var(--btn-outline-border-hover);
    transform: translateY(-1px);
  }

  .btn-outline:active:not(:disabled) {
    background-color: var(--btn-outline-bg-active);
    transform: translateY(0);
  }

  .btn-outline:disabled {
    background-color: transparent;
    color: var(--btn-outline-text-disabled);
    border-color: var(--btn-outline-border-disabled);
  }

  /* Smooth transitions for all states */
  .btn-primary,
  .btn-secondary,
  .btn-ghost,
  .btn-outline {
    transition: background-color var(--duration-fast) var(--timing-smooth),
                color var(--duration-fast) var(--timing-smooth),
                border-color var(--duration-fast) var(--timing-smooth),
                box-shadow var(--duration-fast) var(--timing-smooth),
                transform var(--duration-fast) var(--timing-smooth);
  }

  /* Ensure text remains readable in all states */
  .btn-primary *,
  .btn-secondary *,
  .btn-ghost *,
  .btn-outline * {
    color: inherit;
  }
</style>

